name: System.VFS.MalwareDetection
description: |
   This artifact is designed to detect potential malware activity on a system.
   It checks for unusual file characteristics, suspicious process behaviors, and system changes.

type: CLIENT

sources:
  - name: SuspiciousFiles
    query: |
      SELECT FullPath, Size, Mtime, Hash.MD5, Hash.SHA1, Hash.SHA256
      FROM glob(globs='C:\\Windows\\Temp\\*.exe', accessor='ntfs')
      WHERE Size > 1000000

  - name: UnusualProcessBehavior
    query: |
      SELECT Name, CommandLine, Ctime, Pid, PPid, WorkingSetSize, ThreadCount
      FROM pslist()
      WHERE WorkingSetSize > 100000000 OR ThreadCount > 50

  - name: ModifiedSystemSettings
    query: |
      SELECT Key, Name, Value
      FROM reg_enum_key(globs='HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run')
